# Problem 3

화이트박스 암호는 공격자가 소프트웨어의 내부를 완전히 분석할 수 있는 화이트박스 모델 공격자 환경에서 암호 알고리즘 키를 포함한 내부 정보를 보호하면서 암호 연산을 수행할 수 있도록 설계한 암호입니다.

주어진 소스파일(`wbcases128.c`)은 Chow et al.의 White-box cryptograph and an AES implementation 논문 방식으로 AES-128 암호화를 외부 인코딩 없이 구현한 버전입니다. 즉, 일반 AES-128 암호화와 동일하게 동작합니다. 이를 분석하여 128비트 마스터키를 찾아내고, 그 분석 논리 및 과정을 상세히 문서화하시오.

```
root@7cfb39f0bf08:/workspace/challenge-3/Tracer/TracerGrind/texttrace# head -40 /workspace/challenge-3/wbcaes128.txt
[!] TRACERGRIND_VERSION: 1.4
[!] ARCH: AMD64
[!] PROGRAM: ./wbcaes128
[!] ARGS: 00112233445566778899aabbccddeeff
[T] EXEC_ID: 0 THREAD_ID: 0000000000000001 TYPE: THREAD_CREATE
[M] EXEC_ID: 0 INS_ADDRESS: 0000000004020293 START_ADDRESS: 0000001fff0000d8 LENGTH: 8 MODE: W DATA: 9802020400000000
[B] EXEC_ID: 0 THREAD_ID: 0000000000000001 START_ADDRESS: 0000000004020290 END_ADDRESS: 0000000004020293
[I] 0000000004020290: mov rdi, rsp
[I] 0000000004020293: call 0x4021030
[M] EXEC_ID: 1 INS_ADDRESS: 0000000004021034 START_ADDRESS: 0000001fff0000d0 LENGTH: 8 MODE: W DATA: 0000000000000000
[M] EXEC_ID: 1 INS_ADDRESS: 0000000004021038 START_ADDRESS: 0000001fff0000c8 LENGTH: 8 MODE: W DATA: 0000000000000000
[M] EXEC_ID: 1 INS_ADDRESS: 000000000402103a START_ADDRESS: 0000001fff0000c0 LENGTH: 8 MODE: W DATA: 0000000000000000
[M] EXEC_ID: 1 INS_ADDRESS: 000000000402103c START_ADDRESS: 0000001fff0000b8 LENGTH: 8 MODE: W DATA: 0000000000000000
[M] EXEC_ID: 1 INS_ADDRESS: 000000000402103e START_ADDRESS: 0000001fff0000b0 LENGTH: 8 MODE: W DATA: 0000000000000000
[M] EXEC_ID: 1 INS_ADDRESS: 0000000004021040 START_ADDRESS: 0000001fff0000a8 LENGTH: 8 MODE: W DATA: 0000000000000000
[M] EXEC_ID: 1 INS_ADDRESS: 0000000004021048 START_ADDRESS: 0000001fff000058 LENGTH: 8 MODE: W DATA: e00000ff1f000000
[M] EXEC_ID: 1 INS_ADDRESS: 0000000004021055 START_ADDRESS: 000000000403ae0e LENGTH: 1 MODE: R DATA: 00
[M] EXEC_ID: 1 INS_ADDRESS: 0000000004021055 START_ADDRESS: 000000000403ae0e LENGTH: 1 MODE: W DATA: 00
[M] EXEC_ID: 1 INS_ADDRESS: 000000000402105c START_ADDRESS: 000000000403aaf0 LENGTH: 8 MODE: W DATA: 0000000400000000
[M] EXEC_ID: 1 INS_ADDRESS: 0000000004021071 START_ADDRESS: 0000000004039aa0 LENGTH: 8 MODE: W DATA: 6e19a0b8b10a0000
[M] EXEC_ID: 1 INS_ADDRESS: 0000000004021078 START_ADDRESS: 0000000004039e80 LENGTH: 8 MODE: R DATA: 0e00000000000000
[M] EXEC_ID: 1 INS_ADDRESS: 000000000402107f START_ADDRESS: 000000000403ab00 LENGTH: 8 MODE: W DATA: 809e030400000000
[B] EXEC_ID: 1 THREAD_ID: 0000000000000001 START_ADDRESS: 0000000004021030 END_ADDRESS: 00000000040210be
[I] 0000000004021030: endbr64 
[I] 0000000004021034: push rbp
[I] 0000000004021035: mov rbp, rsp
[I] 0000000004021038: push r15
[I] 000000000402103a: push r14
[I] 000000000402103c: push r13
[I] 000000000402103e: push r12
[I] 0000000004021040: push rbx
[I] 0000000004021041: sub rsp, 0x88
[I] 0000000004021048: mov qword ptr [rbp - 0x78], rdi
[I] 000000000402104c: rdtsc 
[I] 000000000402104e: lea r12, [rip - 0x21055]
[I] 0000000004021055: and byte ptr [rip + 0x19db2], 0xdf
[I] 000000000402105c: mov qword ptr [rip + 0x19a8d], r12
[I] 0000000004021063: shl rdx, 0x20
[I] 0000000004021067: or rax, rdx
[I] 000000000402106a: lea rdx, [rip + 0x18e0f]
```